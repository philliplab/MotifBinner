<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Investigation of various approach to treating mislabel detection</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>Investigation of various approach to treating mislabel detection</h1>

<h2>Overview</h2>

<p>Given a bin of sequences that are theoretically from only a single virus
molecule, remove all of those that are actually from a different molecule.</p>

<p>This is accomplished by looking at the distances between each of the sequences
and removing the outliers.</p>

<p>The difficult parts are deciding how to compute the distances efficiently and
setting the thresholds that start and stop the process.</p>

<p>This process is further complicated by these concerns:
1) bin sizes varies from 1 to several hundred
2) We have to deal with indels
3) This process must be completely automated
4) This process must be very computationally efficient</p>

<h2>Testing strategy</h2>

<p>We need to test the system using bins with known answers. </p>

<h3>Test Data</h3>

<p>As always, the design data structure for the test data is important. Use a
structure like this:</p>

<pre><code class="r">list(&#39;test1&#39; = list(&#39;in&#39; = DNAStringSet(...),
                    &#39;out&#39; = DNAStringSet(...)),
     &#39;test2&#39; = ...)
</code></pre>

<p>The data is available in the package:</p>

<pre><code class="r">test_dat &lt;- get_mislabel_test_data()
</code></pre>

<p>Using this data for a &#39;bin&#39; by putting the &#39;src&#39; and &#39;out&#39; data together and check
that only the &#39;out&#39; data is removed and all the &#39;src&#39; data is kept.</p>

<h3>Basic Code for running tests</h3>

<p>Basic code to run the tests is available from the package:</p>

<pre><code class="r">score_classification()
</code></pre>

<h3>Metrics of interest</h3>

<p>A number of metrics must be considered when looking at the accuracy of
classification.</p>

<p>Keep it basic. </p>

<p>Consider these standard classification metrics:</p>

<h4>Sensitivity:</h4>

<p>Number of true &#39;in&#39; classifications / (Total size of true &#39;in&#39; population)</p>

<h4>Specificity:</h4>

<p>Number of true &#39;out&#39; classifications / (Total size of the &#39;out&#39; population)</p>

<p>Maximize both simultaneously</p>

<p>Now, in addition to these two, there are other metrics of interest that we can
derive based on our knowledge of the system.</p>

<h4>Maximum distance in the final dataset:</h4>

<p>We know that the only source of errors
should be the sequencing process. We have access to data about the error rates
of the sequencing process. We can use this to make a statement like:</p>

<p>The sequencing process is accurate to such a degree that no two reads of the
same molecule should differ by more than one base per 100 bases. Build a metric
around this information.</p>

<h4>Speed</h4>

<p>The time it took to classify the reads in the bin.</p>

<h2>The different strategies</h2>

<p>Design and implement a who set of strategies and then benchmark them to find
the best ones.</p>

<h3>Remove None</h3>

<p>This strategy keeps all the data</p>

<p>Use the random strategy but set the parameter &#39;n&#39; to 0. So that 0 percent of
the data will be randomly removed.</p>

<pre><code class="r">kable(score_all_classifications(test_dat, &#39;random&#39;, params = list(n=0)))
</code></pre>

<table><thead>
<tr>
<th align="left">name</th>
<th align="right">sn</th>
<th align="right">sp</th>
<th align="right">max_dist</th>
<th align="right">time_taken</th>
</tr>
</thead><tbody>
<tr>
<td align="left">test1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">100.000000</td>
<td align="right">0.027</td>
</tr>
<tr>
<td align="left">test2</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">2.941177</td>
<td align="right">0.016</td>
</tr>
<tr>
<td align="left">test3</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4.779412</td>
<td align="right">0.013</td>
</tr>
<tr>
<td align="left">test4</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">8.185053</td>
<td align="right">0.014</td>
</tr>
<tr>
<td align="left">test5</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1.102941</td>
<td align="right">0.013</td>
</tr>
<tr>
<td align="left">test6</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4.779412</td>
<td align="right">0.012</td>
</tr>
<tr>
<td align="left">test7</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">9.252669</td>
<td align="right">0.012</td>
</tr>
<tr>
<td align="left">test8</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">10.294118</td>
<td align="right">0.013</td>
</tr>
<tr>
<td align="left">test9</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">6.250000</td>
<td align="right">0.012</td>
</tr>
<tr>
<td align="left">test10</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">11.783440</td>
<td align="right">0.012</td>
</tr>
</tbody></table>

<h3>Remove Random</h3>

<p>This strategy removes 40% of the sample at random</p>

<pre><code class="r">kable(score_all_classifications(test_dat, &#39;random&#39;, params = list(n=0.4)))
</code></pre>

<table><thead>
<tr>
<th align="left">name</th>
<th align="right">sn</th>
<th align="right">sp</th>
<th align="right">max_dist</th>
<th align="right">time_taken</th>
</tr>
</thead><tbody>
<tr>
<td align="left">test1</td>
<td align="right">1.0000000</td>
<td align="right">0.0000000</td>
<td align="right">100.0000000</td>
<td align="right">0.012</td>
</tr>
<tr>
<td align="left">test2</td>
<td align="right">1.0000000</td>
<td align="right">0.0000000</td>
<td align="right">2.9411765</td>
<td align="right">0.013</td>
</tr>
<tr>
<td align="left">test3</td>
<td align="right">1.0000000</td>
<td align="right">0.3333333</td>
<td align="right">4.7794118</td>
<td align="right">0.021</td>
</tr>
<tr>
<td align="left">test4</td>
<td align="right">0.6666667</td>
<td align="right">0.0000000</td>
<td align="right">8.1850534</td>
<td align="right">0.019</td>
</tr>
<tr>
<td align="left">test5</td>
<td align="right">0.5000000</td>
<td align="right">1.0000000</td>
<td align="right">1.1029412</td>
<td align="right">0.019</td>
</tr>
<tr>
<td align="left">test6</td>
<td align="right">0.1428571</td>
<td align="right">0.0000000</td>
<td align="right">4.7794118</td>
<td align="right">0.020</td>
</tr>
<tr>
<td align="left">test7</td>
<td align="right">0.8571429</td>
<td align="right">1.0000000</td>
<td align="right">0.7117438</td>
<td align="right">0.018</td>
</tr>
<tr>
<td align="left">test8</td>
<td align="right">0.8947368</td>
<td align="right">1.0000000</td>
<td align="right">1.4705882</td>
<td align="right">0.020</td>
</tr>
<tr>
<td align="left">test9</td>
<td align="right">0.7777778</td>
<td align="right">0.5000000</td>
<td align="right">6.2500000</td>
<td align="right">0.018</td>
</tr>
<tr>
<td align="left">test10</td>
<td align="right">0.8400000</td>
<td align="right">0.6000000</td>
<td align="right">8.9171975</td>
<td align="right">0.020</td>
</tr>
</tbody></table>

<h3>Information Variance Balance</h3>

<p>This strategy will keep on removing the most outlying sequence as long as is
leads to a percentage reduction in variance that is x times larger than the
percentage of information that was discarded</p>

<h4>Threshold of 1</h4>

<pre><code class="r">kable(score_all_classifications(test_dat, &#39;infovar_balance&#39;, params = list(threshold = 1)), digits = 2)
</code></pre>

<table><thead>
<tr>
<th align="left">name</th>
<th align="right">sn</th>
<th align="right">sp</th>
<th align="right">max_dist</th>
<th align="right">time_taken</th>
</tr>
</thead><tbody>
<tr>
<td align="left">test1</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">0.00</td>
<td align="right">0.01</td>
</tr>
<tr>
<td align="left">test2</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">0.00</td>
<td align="right">0.01</td>
</tr>
<tr>
<td align="left">test3</td>
<td align="right">1.00</td>
<td align="right">0.33</td>
<td align="right">0.74</td>
<td align="right">0.01</td>
</tr>
<tr>
<td align="left">test4</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">1.78</td>
<td align="right">0.01</td>
</tr>
<tr>
<td align="left">test5</td>
<td align="right">0.50</td>
<td align="right">1.00</td>
<td align="right">0.00</td>
<td align="right">0.01</td>
</tr>
<tr>
<td align="left">test6</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">0.37</td>
<td align="right">0.02</td>
</tr>
<tr>
<td align="left">test7</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">1.07</td>
<td align="right">0.02</td>
</tr>
<tr>
<td align="left">test8</td>
<td align="right">0.95</td>
<td align="right">1.00</td>
<td align="right">1.47</td>
<td align="right">0.10</td>
</tr>
<tr>
<td align="left">test9</td>
<td align="right">0.72</td>
<td align="right">1.00</td>
<td align="right">1.10</td>
<td align="right">0.11</td>
</tr>
<tr>
<td align="left">test10</td>
<td align="right">0.96</td>
<td align="right">1.00</td>
<td align="right">2.87</td>
<td align="right">0.30</td>
</tr>
</tbody></table>

<h4>Threshold of 2</h4>

<pre><code class="r">kable(score_all_classifications(test_dat, &#39;infovar_balance&#39;, params = list(threshold = 2)), digits = 2)
</code></pre>

<table><thead>
<tr>
<th align="left">name</th>
<th align="right">sn</th>
<th align="right">sp</th>
<th align="right">max_dist</th>
<th align="right">time_taken</th>
</tr>
</thead><tbody>
<tr>
<td align="left">test1</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">0.00</td>
<td align="right">0.01</td>
</tr>
<tr>
<td align="left">test2</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">0.00</td>
<td align="right">0.01</td>
</tr>
<tr>
<td align="left">test3</td>
<td align="right">1.00</td>
<td align="right">0.33</td>
<td align="right">0.74</td>
<td align="right">0.01</td>
</tr>
<tr>
<td align="left">test4</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">1.78</td>
<td align="right">0.01</td>
</tr>
<tr>
<td align="left">test5</td>
<td align="right">0.75</td>
<td align="right">1.00</td>
<td align="right">0.37</td>
<td align="right">0.01</td>
</tr>
<tr>
<td align="left">test6</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">0.37</td>
<td align="right">0.02</td>
</tr>
<tr>
<td align="left">test7</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">1.07</td>
<td align="right">0.02</td>
</tr>
<tr>
<td align="left">test8</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">1.84</td>
<td align="right">0.11</td>
</tr>
<tr>
<td align="left">test9</td>
<td align="right">1.00</td>
<td align="right">0.50</td>
<td align="right">2.94</td>
<td align="right">0.10</td>
</tr>
<tr>
<td align="left">test10</td>
<td align="right">1.00</td>
<td align="right">0.80</td>
<td align="right">4.78</td>
<td align="right">0.31</td>
</tr>
</tbody></table>

<h4>Threshold of 3</h4>

<pre><code class="r">kable(score_all_classifications(test_dat, &#39;infovar_balance&#39;, params = list(threshold = 3)), digits = 2)
</code></pre>

<table><thead>
<tr>
<th align="left">name</th>
<th align="right">sn</th>
<th align="right">sp</th>
<th align="right">max_dist</th>
<th align="right">time_taken</th>
</tr>
</thead><tbody>
<tr>
<td align="left">test1</td>
<td align="right">1</td>
<td align="right">0.0</td>
<td align="right">100.00</td>
<td align="right">0.01</td>
</tr>
<tr>
<td align="left">test2</td>
<td align="right">1</td>
<td align="right">0.0</td>
<td align="right">2.94</td>
<td align="right">0.01</td>
</tr>
<tr>
<td align="left">test3</td>
<td align="right">1</td>
<td align="right">0.0</td>
<td align="right">4.78</td>
<td align="right">0.01</td>
</tr>
<tr>
<td align="left">test4</td>
<td align="right">1</td>
<td align="right">1.0</td>
<td align="right">1.78</td>
<td align="right">0.01</td>
</tr>
<tr>
<td align="left">test5</td>
<td align="right">1</td>
<td align="right">1.0</td>
<td align="right">1.10</td>
<td align="right">0.01</td>
</tr>
<tr>
<td align="left">test6</td>
<td align="right">1</td>
<td align="right">1.0</td>
<td align="right">0.37</td>
<td align="right">0.02</td>
</tr>
<tr>
<td align="left">test7</td>
<td align="right">1</td>
<td align="right">1.0</td>
<td align="right">1.07</td>
<td align="right">0.03</td>
</tr>
<tr>
<td align="left">test8</td>
<td align="right">1</td>
<td align="right">1.0</td>
<td align="right">1.84</td>
<td align="right">0.10</td>
</tr>
<tr>
<td align="left">test9</td>
<td align="right">1</td>
<td align="right">0.5</td>
<td align="right">2.94</td>
<td align="right">0.10</td>
</tr>
<tr>
<td align="left">test10</td>
<td align="right">1</td>
<td align="right">0.8</td>
<td align="right">4.78</td>
<td align="right">0.30</td>
</tr>
</tbody></table>

<h3>The silver bullet</h3>

<p>To be devised</p>

</body>

</html>
